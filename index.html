<!DOCTYPE html>
<html>
    <head>
        <title>CryptoStego YASS Version - by @pboueke</title>
        <meta charset="UTF-8">
        </head>
    <body>
        <style>
            html {
                background-color: #b6c7d8;
            }
            body {
                display: flex;
                justify-content: center;
            }
            .body-content {
                max-width: 800px;
                background-color: #fff;
                padding: 30px;
                margin-top: 30px;
                margin-bottom: 30px;
                box-shadow: 0 1px 2px rgba(34, 25, 25, 0.4);
                color: #1d1d1d;
                text-align: center;
            }
            .body-content > * {
                margin: 30px;
            }
            p {
                background-color: #e6e6e6;
                font-size: 20px;
                padding: 10px;
            }
            .demo-body {
                font-size: 20px;
                background-color: #e6e6e6;
                padding: 30px 15px 30px 10px
            }
            #result {
                margin: 15px;
                padding: 10px;
                background-color: #d8d8d8;
            }
            input[type='file'] {
                padding: 5px 15px;
                background: #ccc;
                border: 0 none;
                cursor: pointer;
                -webkit-border-radius: 5px;
                border-radius: 5px;
            }
            .params {
                display: flex;
                justify-content: center;
            }
            .disclaimers {
                padding: 30px 50px 0 50px;
                font-size: 16px;
                text-align: left;
            }
        </style>
        <a href="https://github.com/pboueke/CryptoStego"><img style="position: absolute; top: 0; right: 0; border: 0;" src="example/minimum_example/fork.png" alt="Fork me on GitHub"></a>                    
        <div class="body-content">
            <h1>CryptoStego - YASS Version</h1>
            <p>
                This project is a fork of <a href="https://github.com/zeruniverse">Jeffery Zhaos's</a> 
                <a href="http://stego.js.org/">CryptoStego</a> project, which implements </a> well known 
                steganographic methods and cryptography to hide and protect text in images.
            <br><br>
                This fork implements a new steganographic method, inspired by the <b>YASS</b> method. 
                The implementd method consists of hiding the data inside the 2D Discrete Cosine Transform 
                results of pseudo-randomly spatially located 8x8 blocks of the image. More info on the method
                is available at the "about" section.
            </p>

            <h1>Parameters</h1>

            <div class="demo-body">
                <p>
                    Note that the same parameters used to hide a message must be used to recover it!
                </p>
                <div class="params">
                    <div class="param">Copies* <input type="number" id="copy" value="5"></input> </div>
                    <div class="param">Limit* <input type="number" id="limit" value="30"></input> </div>
                    <div class="param">B block size** <input type="number" id="bsize" value="11"></input> </div>
                </div>
                <div class="disclaimers">
                    <b>*</b> You can read more about copy and limit parameters at the <a href="https://github.com/zeruniverse/CryptoStego#advance-usage">
                    Advanced Usage</a> section of the project readme. There are also sugested values:
                    <ul>
                        <li>Level 0: [Copies:5][Limit:30] - Best Secrecy, No Robustness to Compression</li>
                        <li>Level 1: [Copies:11][Limit:15] - (Warning: This level has very low data capacity)</li>
                        <li>Level 2: [Copies:9][Limit:20] </li>
                        <li>Level 3: [Copies:5][Limit:30] </li>
                        <li>Level 4: [Copies:5][Limit:35] </li>
                        <li>Level 5: [Copies:5][Limit:50] - Best Robustness to Compression, Worst Secrecy</li>
                    </ul>
                    <br>
                    <b>**</b> B size is the outer B block size used by the YASS method.
                </div>
            </div>
            
            <h1>Hide a Message</h1>            

            <div class="demo-body">
                Select an image: <input type="file" id="file" accept="image/*" /> <br /><br />
                Security Password: <input type="text" id="pass" value="" /> <br /><br />
                <textarea id="msg" style="width:100%;height:80px;" placeholder="Your Message Here!"></textarea> <br /><br />
                <button onclick='writeIMG()'>Hide My message to this Image</button>
            </div>

            <h1>Recover a Message</h1>

            <div class="demo-body">
                Select an image: <input type="file" id="file1" accept="image/*" /> <br /><br />
                Security Password: <input type="text" id="pass1" value="" /> <br /><br />
                <button onclick='readIMG()'>Read My MSG from Image</button><br /><br />
                Results:<br />
                <div id="result"></div>
            </div>
        </div>
    </body>
    <script src="example/minimum_example/jquery.min.js"></script>
    <script src="src/sha512.js"></script>
    <script src="src/utf_8.js"></script>
    <script src="src/crypto.js"></script>
    <script src="src/custom-rnd.js"></script>
    <script src="src/readimg.js"></script>
    <script src="src/setimg.js"></script>
    <script src="src/main.js"></script>
    <script>
    function writeIMG(){
        function writefunc(){
            if(writeMsgToCanvas('canvas',$("#msg").val(),$("#pass").val(),6,
            parseInt($("#copy").val()),parseInt($("#limit").val()),parseInt($("#bsize").val()))!=null){ 
                var myCanvas = document.getElementById("canvas");  
                var image = myCanvas.toDataURL("image/jpeg",1.0);    
                var element = document.createElement('a');
                element.setAttribute('href', image);
                element.setAttribute('download', 'result.jpg');
                element.style.display = 'none';
                document.body.appendChild(element);
                element.click();
                document.body.removeChild(element);        
        }
        }
        loadIMGtoCanvas('file','canvas',writefunc,500);
    }
    function readIMG(){
        function readfunc(){
            var t=readMsgFromCanvas('canvas',$("#pass1").val(),6,
                  parseInt($("#copy").val()),parseInt($("#limit").val()),parseInt($("#bsize").val()));
            if(t!=null){
                t=t.split('&').join('&amp;');
                t=t.split(' ').join('&nbsp;'); 
                t=t.split('<').join('&lt;');
                t=t.split('>').join('&gt;');
                t=t.replace(/(?:\r\n|\r|\n)/g, '<br />');
                $("#result").html(t);
            }else $("#result").html('ERROR REAVEALING MESSAGE!');
                
        }
        loadIMGtoCanvas('file1','canvas',readfunc);
    }
    </script>
</html>
